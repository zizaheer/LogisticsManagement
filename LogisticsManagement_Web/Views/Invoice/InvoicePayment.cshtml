
@{
    ViewData["Title"] = "PAYMENT";
}


<h3>
    @ViewData["Title"]
</h3>
<hr />
<script>
    $(document).ready(function () {
        if ($.fn.dataTable.isDataTable('#customer-wise-due-invoices')) {
            $('#customer-wise-due-invoices').DataTable().destroy();
        }
        $('#customer-wise-due-invoices').DataTable({
            "order": [[0, "asc"]],
            "language": {
                searchPlaceholder: 'Search...',
                search: "<i class='fa fa-search'></i>",
            },
            "paging": true,
            "info": false,
            "searching": true
        });
    });
</script>


<div class="modal fade" id="collectPayment" tabindex="-1" role="dialog" style="text-transform:uppercase">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content bg-light">
            <div class="modal-header">
                <label class="modal-title mr-1"> COLLECT PAYMENT FOR </label>
                <strong>
                    [ <label id="lblCustomerName" style="margin-right:10px"></label> #<label id="lblCustomerNo" style="margin-left:2px"></label> ]
                </strong>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                
                <div class="row mt-2">
                    <div class="col-sm-12">
                        <table class="table table-sm table-bordered table-striped" cellspacing="0" style="width:100%; font-size:.75em">
                                <thead class="dtTheadBg">
                                    <tr>
                                        <th style="width:240px">Invoice #</th>
                                        <th style="width:240px">Invoice date</th>
                                        <th style="width:240px">Invoice amount</th>
                                        <th style="width:240px">Paid amount</th>
                                        <th style="width:auto">Due amount</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                      
                        <div style="display:block; height:120px; overflow-y:scroll; overflow-x:hidden; border:1px solid #c3c3c3; margin-bottom:15px; margin-top:-16px" id="loadPartialViewCustomerWiseDueInvoices">
                            <table id="customer-wise-due-invoices" class="table table-sm table-striped customer-wise-due-invoices" cellspacing="0" style="width:100%; margin-top: -1px !important; font-size:.75em">
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="row">
                    
                        <div class="col-sm-7">
                            <fieldset style="background-color:#e6f0f7">
                                <legend>WB INFO</legend>
                                <div class="row mt-0 mb-2">
                                    <div class="form-group col-sm-3">
                                       <label for="txtInvoiceNo" class="captionWeight">Invoice #</label>
                                        <input type="text" id="txtInvoiceNo" class="form-control form-control-sm frmfontsize" style="font-weight:bolder" placeholder="Invoice #" readonly/>
                                    </div>
                                    <div class="form-group col-sm-3">
                                        <label for="txtPaidAmount" class="captionWeight">PAID</label>
                                        <input type="text" id="txtPaidAmount" class="form-control form-control-sm frmfontsize" readonly />
                                    </div>
                                    <div class="form-group col-sm-3">
                                       <label for="txtDueAmount" class="captionWeight">DUE</label>
                                        <input type="text" id="txtDueAmount" class="form-control form-control-sm frmfontsize" readonly />
                                    </div>
                                    <div class="form-group col-sm-3">
                                        <label for="txtInvoiceDate" class="captionWeight">INV. DATE</label>
                                        <input type="date" id="txtInvoiceDate" class="form-control form-control-sm frmfontsize" readonly />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-12">
                                        <div style="display:block; height:229px; overflow-y:scroll; overflow-x:hidden; border:1px solid #c3c3c3;" id="loadPartialViewCustomerWiseDueInvoices">
                                            <table class="table table-sm table-striped waybill-list-for-invoice-payment" style="width:100%; font-size:.75em">
                                                <thead class="dtTheadBg">
                                                    <tr>
                                                        <th>W/B No</th>
                                                        <th>Pickup date</th>
                                                        <th>Delivery date</th>
                                                        <th>Total amount</th>
                                                        @*<th>Total Tax</th>*@
                                                        <th>
                                                            <div class="form-check-inline">
                                                                <input type="checkbox" class="form-check-input chkPayAllWaybill" id="chkPayAllWaybill">
                                                                <label class="form-check-label" for="chkPayAllWaybill">Pay</label>
                                                            </div>
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody></tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </fieldset>
                            
                        </div>
                        <div class="col-sm-5">
                            <fieldset style="background-color:#e6f0f7">
                                <legend>PAYMENT INFO</legend>
                                <div class="row">
                                    <div class="form-group col-sm-6">
                                        <small><b><label for="ddlPaymentMethodId">Payment method:</label></b></small>
                                        <select class="form-control form-control-sm ddlPaymentMethodId" id="ddlPaymentMethodId">
                                            @foreach (var item in ViewBag.PaymentMethods)
                                            {
                                                var selected = false;
                                                if (item.Id == 1)
                                                { selected = true; }

                                                <option value="@item.Id" selected="@selected">@item.MethodName</option>
                                            }

                                        </select>
                                    </div>
                                    <div class="form-group col-sm-6">
                                        <small><b><label>Banking info</label></b></small>
                                        <div class="form-check-inline">
                                            <input type="checkbox" class="form-check-input" id="chkKeepBankingInformation" />
                                            <small><label class="form-check-label" for="chkKeepBankingInformation">Apply to next inv.</label></small>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-sm-6">
                                        <small><b><label for="ddlBankId">Bank name:</label></b></small>
                                        <select class="form-control form-control-sm ddlBankId" id="ddlBankId">
                                            <option value="0">-Select-</option>
                                            @foreach (var item in ViewBag.Banks)
                                            {
                                                <option value="@item.Id">@item.BankName</option>
                                            }

                                        </select>
                                    </div>
                                    <div class="form-group col-sm-6">
                                        <small><b><label for="txtChequeNo">Cheque no:</label></b></small>
                                        <input type="text" id="txtChequeNo" class="form-control form-control-sm" />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-sm-6">
                                        <small><b><label for="txtChequeAmount">Cheque amt.:</label></b></small>
                                        <input type="number" id="txtChequeAmount" class="form-control form-control-sm" />
                                    </div>

                                    <div class="form-group col-sm-6">
                                        <small><b><label for="txtChequeDate">Cheque date:</label></b></small>
                                        <input type="date" id="txtChequeDate" class="form-control form-control-sm" />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-sm-4">
                                        <small><b><label for="txtCashAmount">Cash amt.:</label></b></small>
                                        <input type="number" id="txtCashAmount" class="form-control form-control-sm" disabled />
                                    </div>
                                    <div class="form-group col-sm-4">
                                        <small><b><label for="txtPaymentApplied">Applied</label></b></small>
                                        <input type="number" id="txtPaymentApplied" class="form-control form-control-sm" />
                                    </div>
                                    <div class="form-group col-sm-4">
                                        <small><b><label for="txtRemainingAmount">Remaining</label></b></small>
                                        <input type="number" id="txtRemainingAmount" class="form-control form-control-sm" disabled />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-sm-12">
                                        <small><b><label for="txtPaymentRemarks">Remarks:</label></b></small>
                                        <input id="txtPaymentRemarks" class="form-control form-control-sm" />
                                    </div>
                                </div>
                            </fieldset>
                        </div>
                   
                </div>

            </div>
            <div class="modal-footer padding-lg">
                <button type="button" class="btn btn-sm btn-primary"  id="btnMakePayment"> APPLY PAYMENT</button>
                <button type="button" class="btn btn-sm btn-secondary" data-dismiss="modal" id="btnCloseModal"> CLOSE</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="paidInvoiceModal" tabindex="-1" role="dialog" style="text-transform:uppercase">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content bg-light">
            <div class="modal-header">
                <label class="modal-title mr-1"> PAID INVOICES  </label>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <div style="display:block;" id="loadCustomerWiseInvoices">
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-sm btn-secondary" data-dismiss="modal" id="btnCloseModal"> CLOSE</button>
            </div>
        </div>
    </div>
</div>

<form id="frmInvoicePaymentForm">
    <div class="row">
        <div class="col-sm-6 input-group">
            <select class="col-6 form-control form-control-sm" id="ddlCustomerId">
                <option value="0">All Customer</option>
                @foreach (var customer in ViewBag.Customers)
                {
                    <option value="@customer.Id">@customer.CustomerName</option>

                }

            </select>
            <select class="col-3 form-control form-control-sm" id="ddlYear">
                <option value="0">All</option>
                <option value="@DateTime.Now.ToString("yyyy")">@DateTime.Now.ToString("yyyy")</option>
                <option value="@DateTime.Now.AddYears(-1).ToString("yyyy")">@DateTime.Now.AddYears(-1).ToString("yyyy")</option>
            </select>
            <div class="col-2 form-control form-control-sm form-check-inline" style="display:none">
                <input class="form-check-input" type="checkbox" id="chkShowPaidInvoice" style="margin-left:10px !important" />
                <label class="form-check-label" id="" for="chkShowPaidInvoice">Paid</label>
            </div>
            <div class="col-sm-2">
                <button class="btn btn-sm btn-dark" id="btnShowRecords" style="margin-bottom:10px" type="button">Show</button>
            </div>

        </div>
    </div>
    <hr />
    <div class="row">
        <div class="col-md-12">
            <div style="display:block; margin-bottom:15px" id="loadCustomersInvoiceDue">
                <partial name="_PartialViewCustomersInvoiceDue" />
            </div>
        </div>
    </div>

    <hr />
</form>

<br /><br />


<script src="~/js/invoice.js"></script>

